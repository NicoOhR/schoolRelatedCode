---
title: "hw7"
output:
  pdf_document: default
  html_document: default
---

## Question 1

### a)

```{r}
df <- read.csv("football.csv")
model <- lm(y ~ x2 + x7 + x8, data = df)
```

Standardized residuals: 
```{r, warning=FALSE}
library(MASS)
library(knitr)
stand_res <- matrix(stdres(model), ncol = 2, byrow=TRUE)
knitr::kable(stand_res, caption="standardized residuals")
```
```{r, warning=FALSE}
stud_res <- matrix(studres(model), ncol = 2)
knitr::kable(stud_res, caption="studentized residuals")
```
```{r, warning=FALSE}
r_student_res <- matrix(rstudent(model), ncol = 2)
knitr::kable(stud_res, caption="R-studentized residuals")
```

```{r, warning=FALSE}
par(mfrow = c(1,3))

mp1 <- barplot(stdres(model),
               main = "standardized residuals",
               ylim = c(-5,5))
abline(h = 0, lwd = 2)
abline(h = c(-3, 3), lty = 2)
mp2 <- barplot(studres(model),
               main = "studentized residuals",
               ylim = c(-5,5))
abline(h = 0, lwd = 2)
abline(h = c(-2, 2), lty = 2)

mp3 <- barplot(rstudent(model),
               main = "R studentized residuals",
               ylim = c(-5,5))
cor.level <- 0.05/(2*28)
cor.qt <- qt(cor.level, 28 - 11 - 1, lower.tail = F)
abline(h = 0, lwd = 2)
abline(h = c(-cor.qt, cor.qt), lty = 2)

```

From these plots and the calculated thresholds, we can see that no points are threshold for the standardized and R-studentized residuals, but the first data point is perhaps an outlier according to the studentized residual. This would imply that the this data point is more influential on the variance of the model than it is to the fitted coefficients of the model, since once it is removed from the variance estimate in the R-student distribution, it is no longer suspicious. 

### b)

```{r, warning=FALSE, message=FALSE}
library(car)
knitr::kable(summary(influence.measures(model)))
dfbetasPlots(model, intercept = T)
influenceIndexPlot(model)
```
From the summary, we see that the potentially influential points are only identified by a high COVRATIO value. Since non of the other measures report as suspicious and are in fact really quite low, this implies that several of the variables do not significantly change the fitted parameters, or the predicted outcome, but are quite damaging to the overall variance of the model, and cause a degradation in precision. 

### c)

```{r, warning=FALSE}
knitr::kable(vif(model))
```

Since non of the predictors have a variance inflation factor of above 10, there are probably no serious problems with multicolinearlity in this model.


### d)

```{r}
par(mfrow=c(1,2))
hist(studres(model), breaks=10, freq=F)
qqPlot(model)
```
In the middle of the QQ plot, we can see that some of the data points fall outside of the allowed interval. This is likely a result of the disproportionate amount of residuals near and slightly under 0, which produces an empirical distribution which is more likely to produce slightly smaller residuals than an idealized t-distribution. However, largely I do not believe that there is any issue with the normality assumption in this case. 

### e) 

```{r}
residualPlot(model, type="rstudent", quadratic=F)
```