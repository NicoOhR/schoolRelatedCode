{"cmd": "df = pd.read_csv(\"wine.txt\", sep=\"\\t\")\n\nresponse_col = \"Quality\"\ndf = pd.get_dummies(df, columns=[\"Region\"], drop_first=True)\npredictor_cols = [col for col in df.columns if col != response_col]\n\nX = df[predictor_cols]\ny = df[response_col]\n\n\ndef loocv_ridge_mse(X, y, alpha):\n    loo = LeaveOneOut()\n    preds = []\n    actuals = []\n    for train_idx, test_idx in loo.split(X):\n        X_train, X_test = X.iloc[train_idx], X.iloc[test_idx]\n        y_train, y_test = y.iloc[train_idx], y.iloc[test_idx]\n\n        model = Lasso(alpha=alpha).fit(X_train, y_train)\n        preds.append(model.predict(X_test)[0])\n        actuals.append(y_test)\n    return mean_squared_error(actuals, preds)\n\n\nerrors = []\nalpha_grid = np.logspace(-3, 3, 50)\nfor alpha in alpha_grid:\n    mse_val = loocv_ridge_mse(X, y, alpha)\n    errors.append((mse_val, alpha))\n\nprint(min(errors))", "cmd_opts": "", "import_complete": 1, "terminal": "nvimterm"}